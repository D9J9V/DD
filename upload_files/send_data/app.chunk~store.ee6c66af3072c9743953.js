(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{10:function(e,t,n){"use strict";n.d(t,"b",(function(){return O}));n.d(t,"a",(function(){return p}));var o=n(0);var c=n.n(o);var r=n(294);var i=n(1335);var a=n(609);var s=n(1337);var u=n(593);var d=n(158);var l=undefined&&undefined.__awaiter||function(e,t,n,o){function c(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o["throw"](e))}catch(e){r(e)}}function s(e){e.done?n(e.value):c(e.value).then(i,a)}s((o=o.apply(e,t||[])).next())}))};const f=e=>Object.assign({},e);function v(e){return Object(d["a"])("noop",e,{shouldPersist:false})}function h(e){return(t,n)=>{if(n.type==="__initialize__"){return e(undefined,n)}return e(t,n)}}function y(e){return e.length===0}function p(e){const t=Object(r["createStore"])(f,{},Object(i["composeWithDevTools"])(Object(r["applyMiddleware"])(s["a"])));const n=Object(a["c"])(t,{manualPersist:true});const o=()=>l(this,void 0,void 0,(function*(){yield n.flush();yield Object(d["c"])(t)}));const p=y(e)?Promise.resolve(e()):Promise.resolve(e);const m=p.then((e=>{const o=Object(d["b"])(e)?e:v(e);const c=h(o);t.replaceReducer(c);t.dispatch({type:"__initialize__"});n.persist()})).then((()=>Object(d["d"])(n)));const _={useSelector(e,n){const o=Object(u["b"])((()=>e(t.getState())),n);return o},useDispatch(){return t.dispatch}};const O=c.a.lazy((()=>l(this,void 0,void 0,(function*(){yield m;const e=e=>c.a.createElement(u["a"],{store:e.store},e.children);return{default:e}}))));const b=e=>{const{children:n,loading:o=null}=e;return c.a.createElement(c.a.Suspense,{fallback:o},c.a.createElement(O,{store:t},n))};return Object.assign(t,{ready:m,syncPersistor:o,hooks:_,Provider:b})}var m=undefined&&undefined.__awaiter||function(e,t,n,o){function c(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o["throw"](e))}catch(e){r(e)}}function s(e){e.done?n(e.value):c(e.value).then(i,a)}s((o=o.apply(e,t||[])).next())}))};function _(){return m(this,void 0,void 0,(function*(){const[{System:e},{Theme:t},{Auth:o},{UIThread:c}]=yield Promise.all([n.e(25).then(n.bind(null,3046)),n.e(25).then(n.bind(null,3047)),n.e(25).then(n.bind(null,3048)),n.e(25).then(n.bind(null,3049))]);return Object(r["combineReducers"])({System:e,Theme:t,Auth:o,UIThread:c})}))}const O=p(_)},134:function(e,t,n){"use strict";n.d(t,"f",(function(){return _}));n.d(t,"h",(function(){return O}));n.d(t,"g",(function(){return b}));n.d(t,"i",(function(){return g}));n.d(t,"b",(function(){return j}));n.d(t,"e",(function(){return A}));n.d(t,"a",(function(){return E}));n.d(t,"c",(function(){return T}));n.d(t,"d",(function(){return w}));var o=n(277);var c=n(31);var r=n(330);const i="system/START_JSON_RPC_MESSAGE_CHANNEL";const a="system/STOP_JSON_RPC_MESSAGE_CHANNEL";const s="system/START_THEME_PREVIEW_MESSAGE_CHANNEL";const u="system/STOP_THEME_PREVIEW_MESSAGE_CHANNEL";const d="system/FORTMATIC_OVERLAY_GREENLIGHT";const l="system/FORTMATIC_SHOW_OVERLAY";const f="system/FORTMATIC_HIDE_OVERLAY";const v="system/PUSH_PAYLOAD_HISTORY";const h="system/SET_SHOW_UI";const y="system/SET_SYSTEM_CLOCK_OFFSET";var p=n(153);var m=n(72);const _=Object(c["createAction"])(i,(()=>{Object(m["f"])();window.addEventListener("message",p["a"].rpc.handle)}))();const O=Object(c["createAction"])(a,(()=>{window.removeEventListener("message",p["a"].rpc.handle)}))();const b=Object(c["createAction"])(s,(()=>{window.addEventListener("message",p["a"].themePreview.handle);p["a"].themePreview.postReady()}))();const g=Object(c["createAction"])(u,(()=>{window.removeEventListener("message",p["a"].themePreview.handle)}))();const j=Object(c["createAction"])(d,(()=>{p["a"].rpc.post(o["FmIncomingWindowMessage"].FORTMATIC_OVERLAY_READY);p["a"].rpc.post(r["c"].MAGIC_OVERLAY_READY)}))();const A=Object(c["createAction"])(l,(()=>{p["a"].rpc.post(o["FmIncomingWindowMessage"].FORTMATIC_SHOW_OVERLAY);p["a"].rpc.post(r["c"].MAGIC_SHOW_OVERLAY)}))();const E=Object(c["createAction"])(f,(()=>{p["a"].rpc.post(o["FmIncomingWindowMessage"].FORTMATIC_HIDE_OVERLAY);p["a"].rpc.post(r["c"].MAGIC_HIDE_OVERLAY)}))();const T=Object(c["createAction"])(h,(e=>e))();const w=Object(c["createAction"])(y,(e=>e-Date.now()))()},146:function(e,t,n){"use strict";n.d(t,"c",(function(){return s}));n.d(t,"b",(function(){return u}));n.d(t,"d",(function(){return d}));n.d(t,"a",(function(){return l}));var o=n(31);const c="uiThread/SET_UI_THREAD_PAYLOAD";const r="uiThread/SET_UI_THREAD_ERROR";const i="uiThread/SET_UI_THREAD_RENDER_FN";const a="uiThread/SET_RETURN_ROUTE_PAGE_ID";const s=Object(o["createAction"])(c,(e=>e))();const u=Object(o["createAction"])(r,(e=>e))();const d=Object(o["createAction"])(i,(e=>e))();const l=Object(o["createAction"])(a,(e=>e))()},158:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));n.d(t,"b",(function(){return f}));n.d(t,"c",(function(){return v}));n.d(t,"d",(function(){return h}));var o=n(609);var c=n(8);var r=n.n(c);var i=n(376);var a=undefined&&undefined.__awaiter||function(e,t,n,o){function c(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o["throw"](e))}catch(e){r(e)}}function s(e){e.done?n(e.value):c(e.value).then(i,a)}s((o=o.apply(e,t||[])).next())}))};const s={getItem:()=>a(void 0,void 0,void 0,(function*(){})),setItem:()=>a(void 0,void 0,void 0,(function*(){})),removeItem:()=>a(void 0,void 0,void 0,(function*(){}))};const u=new Map;const d=Symbol("If this symbol is present on a reducer function, that means we've already processed it with `redux-persist`!");function l(e,t,n={}){const{shouldPersist:r=true}=n;const a=Object(c["merge"])({},n,{storage:r?i["a"].data:s,key:e});const l=Object(o["b"])(a,t);l[d]=true;if(r){u.set(e,{whitelist:a.whitelist,blacklist:a.blacklist,storage:a.storage})}return l}function f(e){return!!e[d]}function v(e){return a(this,void 0,void 0,(function*(){const t=[...u.keys()];yield Promise.all(t.map((t=>a(this,void 0,void 0,(function*(){const{whitelist:n=[],blacklist:c=[],storage:r}=u.get(t);try{const i=yield r.getItem(`persist:${t}`);const a=JSON.parse(i!==null&&i!==void 0?i:"{}");const s=Object.keys(a).reduce(((e,t)=>{if(n&&!n.includes(t))return e;if(c&&c.includes(t))return e;try{e[t]=JSON.parse(a[t]);return e}catch(e){}return e}),{});e.dispatch({key:t,payload:s,type:o["a"]})}catch(e){}})))))}))}function h(e){return new Promise((t=>{const n=()=>{if(e.getState().bootstrapped){o();t(true)}};const o=e.subscribe(n);n()}))}},1590:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var o=n(323);var c=n(35);var r=n(22);var i=n(102);var a=n(170);var s=n(1652);var u=n(159);var d=n(512);var l=n(293);var f=undefined&&undefined.__awaiter||function(e,t,n,o){function c(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o["throw"](e))}catch(e){r(e)}}function s(e){e.done?n(e.value):c(e.value).then(i,a)}s((o=o.apply(e,t||[])).next())}))};function v(){return e=>f(this,void 0,void 0,(function*(){var t,n,s;const u=Object(c["c"])(r["a"].Client.PreviewV1);e(Object(d["a"])(Object.assign(Object.assign({},Object(o["a"])(Object.assign(Object.assign({},i["a"].config),{primaryColor:Object(a["a"])(`#${u.color}`)?`#${u.color}`:i["a"].hex.primary.base,type:u.themeType}))),{customBrandingType:(t=u.customBrandingType)!==null&&t!==void 0?t:i["a"].customBrandingType,logoImage:(n=u.logoImage)!==null&&n!==void 0?n:i["a"].logoImage,appName:(s=u.appName)!==null&&s!==void 0?s:i["a"].appName,isPreview:true})))}))}function h(){return e=>f(this,void 0,void 0,(function*(){var t,n,c,r,a;try{const u=yield s["a"].retrieve();e(Object(d["a"])(Object.assign(Object.assign({},Object(o["a"])(Object.assign(Object.assign({},i["a"].config),{primaryColor:(t=u.data.button_color)!==null&&t!==void 0?t:i["a"].hex.primary.base,type:(n=u.data.theme_color)!==null&&n!==void 0?n:undefined}))),{customBrandingType:(c=u.data.custom_branding_type)!==null&&c!==void 0?c:i["a"].customBrandingType,logoImage:(r=u.data.asset_uri)!==null&&r!==void 0?r:i["a"].logoImage,appName:(a=u.data.app_name)!==null&&a!==void 0?a:i["a"].appName,isPreview:false})))}catch(e){}}))}function y(e){return t=>f(this,void 0,void 0,(function*(){var n,c,r,a,s;t(Object(d["a"])(Object.assign(Object.assign({},Object(o["a"])(Object.assign(Object.assign({},i["a"].config),{primaryColor:(n=e===null||e===void 0?void 0:e.button_color)!==null&&n!==void 0?n:i["a"].hex.primary.base,type:(c=e===null||e===void 0?void 0:e.theme_color)!==null&&c!==void 0?c:undefined}))),{customBrandingType:(r=e===null||e===void 0?void 0:e.custom_branding_type)!==null&&r!==void 0?r:i["a"].customBrandingType,logoImage:(a=e===null||e===void 0?void 0:e.asset_uri)!==null&&a!==void 0?a:i["a"].logoImage,appName:(s=e===null||e===void 0?void 0:e.app_name)!==null&&s!==void 0?s:i["a"].appName,isPreview:false})))}))}function p(){return e=>f(this,void 0,void 0,(function*(){const t=Object(u["a"])();switch(t){case r["a"].Client.SendV1:return e(m.hydrateThemeFromApiResponse());case r["a"].Client.ConfirmV1:case r["a"].Client.ConfirmEmailV1:case r["a"].Client.LoginV1:{const{ct:t}=Object(c["c"])(r["a"].Client.ConfirmV1);if(t)return e(m.hydrateThemeFromRawConfig(t));break}case r["a"].Client.PreviewV1:return e(m.hydrateThemeFromPreviewQuery());default:{const t=Object(l["d"])();if(t)return e(m.hydrateThemeFromRawConfig(t));break}}}))}const m={hydrateThemeFromRawConfig:y,bootstrapTheme:p,hydrateThemeFromApiResponse:h,hydrateThemeFromPreviewQuery:v}},161:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var o=n(9);var c=n(226);var r=n(134);var i=n(51);var a=n(146);var s=undefined&&undefined.__awaiter||function(e,t,n,o){function c(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o["throw"](e))}catch(e){r(e)}}function s(e){e.done?n(e.value):c(e.value).then(i,a)}s((o=o.apply(e,t||[])).next())}))};function u(e,t){return(n,i)=>s(this,void 0,void 0,(function*(){const s=i().UIThread.payload;if(e.method===(s===null||s===void 0?void 0:s.method)){yield o["q"].client.duplicatePayload(e.method).sdkReject(e);return false}yield c["c"].acquire();n(Object(r["c"])(true));n(Object(a["c"])(e));n(Object(a["b"])(undefined));n(Object(a["d"])(t));return true}))}function d(e){return(t,n)=>s(this,void 0,void 0,(function*(){const{payload:o}=n().UIThread;if(c["c"].getPermits()===0&&!!o){t(Object(a["c"])(undefined));yield t(i["a"].resolveJsonRpcResponse(Object.assign({payload:o},e)));t(Object(r["c"])(false));t(Object(a["d"])(undefined));c["c"].release()}}))}const l={releaseLockAndHideUI:d,acquireLockAndShowUI:u}},33:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));n.d(t,"m",(function(){return g}));n.d(t,"b",(function(){return j}));n.d(t,"l",(function(){return A}));n.d(t,"p",(function(){return E}));n.d(t,"o",(function(){return T}));n.d(t,"k",(function(){return w}));n.d(t,"f",(function(){return S}));n.d(t,"e",(function(){return I}));n.d(t,"i",(function(){return C}));n.d(t,"h",(function(){return k}));n.d(t,"c",(function(){return R}));n.d(t,"n",(function(){return U}));n.d(t,"g",(function(){return D}));n.d(t,"j",(function(){return P}));n.d(t,"d",(function(){return L}));var o=n(31);const c="auth/INIT_AUTH_STATE";const r="auth/SET_USER_ID";const i="auth/SET_CLIENT_ID";const a="auth/SET_USER_EMAIL";const s="auth/SET_UST";const u="auth/SET_RT";const d="auth/SET_DELEGATED_WALLET_INFO";const l="auth/SET_USER_KEYS";const f="auth/SET_LOGIN_TYPE";const v="auth/SET_USER_PHONE_NUMBER";const h="auth/SET_USER_MFA_ACTIVE";const y="auth/SET_LOGIN_FLOW_CONTEXT";const p="auth/SET_LOGIN_FACTORS_REQUIRED";const m="auth/SET_USER_CONSENT_TYPES";const _="auth/SET_USED_CHAIN_IDS";const O="auth/SET_IS_NEW_USER";const b=Object(o["createAction"])(c)();const g=Object(o["createAction"])(r,(e=>e))();const j=Object(o["createAction"])(i,(e=>e))();const A=Object(o["createAction"])(a,(e=>e))();const E=Object(o["createAction"])(v,(e=>e))();const T=Object(o["createAction"])(h,(e=>e))();const w=Object(o["createAction"])(m,(e=>e))();const S=Object(o["createAction"])(y,(e=>e))();const I=Object(o["createAction"])(p,(e=>e))();const C=Object(o["createAction"])(s,(e=>e))();const k=Object(o["createAction"])(u,(e=>e))();const R=Object(o["createAction"])(d,(e=>e))();const U=Object(o["createAction"])(l,(e=>e))();const D=Object(o["createAction"])(f,(e=>e))();const P=Object(o["createAction"])(_,(e=>e))();const L=Object(o["createAction"])(O,(e=>e))()},51:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var o=n(330);var c=n(8);var r=n(277);var i=n(9);var a=n(153);var s=n(14);const u=e=>e.Auth||{};const d=e=>u(e).rt;var l=n(72);var f=n(777);var v=undefined&&undefined.__awaiter||function(e,t,n,o){function c(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o["throw"](e))}catch(e){r(e)}}function s(e){e.done?n(e.value):c(e.value).then(i,a)}s((o=o.apply(e,t||[])).next())}))};function h(e){return(t,n)=>v(this,void 0,void 0,(function*(){var t,u,v;const h=Object(i["m"])(e.error)?e.error.jsonRpcError:(t=e.error)!==null&&t!==void 0?t:undefined;const y=!Object(c["isUndefined"])(h);const p=!Object(c["isUndefined"])(e.result)&&!y;const m={jsonrpc:(u=e.payload.jsonrpc)!==null&&u!==void 0?u:"2.0",id:(v=e.payload.id)!==null&&v!==void 0?v:null,result:p?e.result:undefined,error:y?h:undefined};Object(l["e"])(e.payload,n,p);const _=d(n());a["a"].rpc.post(r["FmIncomingWindowMessage"].FORTMATIC_HANDLE_RESPONSE,m,_);a["a"].rpc.post(o["c"].MAGIC_HANDLE_RESPONSE,m,_);f["a"].remove(e.payload);Object(s["e"])(e.payload).emit("done")}))}function y(e){return()=>v(this,void 0,void 0,(function*(){var t,n;const{payload:c,event:r,params:i=[]}=e;const s={jsonrpc:(t=c.jsonrpc)!==null&&t!==void 0?t:"2.0",id:(n=c.id)!==null&&n!==void 0?n:null,result:{event:r,params:i}};a["a"].rpc.post(o["c"].MAGIC_HANDLE_EVENT,s)}))}const p={emitJsonRpcEvent:y,resolveJsonRpcResponse:h}},512:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(31);const c="theme/SET_THEME";const r=Object(o["createAction"])(c,(e=>e))()},62:function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var o=n(277);var c=n.n(o);var r=n(8);var i=n.n(r);var a=n(9);var s=n(104);var u=n(68);var d=n(162);var l=n(186);var f=n(153);var v=n(49);var h=n(27);var y=n(331);var p=n(1035);var m=n(28);var _=n(738);var O=n(14);var b=n(1653);var g=n(175);var j=n(199);var A=n(35);var E=n(22);var T=n(67);var w=n(51);var S=n(134);var I=n(33);var C=n(1654);var k=n(495);var R=n(1589);var U=undefined&&undefined.__awaiter||function(e,t,n,o){function c(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o["throw"](e))}catch(e){r(e)}}function s(e){e.done?n(e.value):c(e.value).then(i,a)}s((o=o.apply(e,t||[])).next())}))};function D(e,t,n){return(o,c)=>U(this,void 0,void 0,(function*(){try{o(Object(I["a"])());o(Object(I["l"])(e));const c=Object(j["c"])(128);const{jwt:r}=Object(O["d"])(n);yield o(G.sendMagicLink(c,t,n,r));yield o(G.waitForMagicLinkClicked(c,e,r));yield o(G.persistSessionCookies(c));yield o(G.populateUserCredentials())}catch(e){l["a"].clear("eth_accounts","eth_coinbase");if(Object(a["m"])(e)||Object(a["l"])(e))throw e;if(Object(a["n"])(e))throw e.getControlFlowError();throw a["q"].client.userDeniedAccountAccess()}}))}function P(e,t){return(n,o)=>U(this,void 0,void 0,(function*(){try{n(Object(I["a"])());const{auth_user_id:o,auth_user_session_token:c,refresh_token:r,email:i,rom:a}=(yield s["a"].redirectLogin(e,t)).data;n(Object(I["l"])(i));n(Object(I["m"])(o));n(Object(I["i"])(c));n(Object(I["h"])(r));yield n(G.persistSessionCookies(a));yield n(G.populateUserCredentials())}catch(e){l["a"].clear("eth_accounts","eth_coinbase");if(Object(a["m"])(e)||Object(a["l"])(e))throw e;if(Object(a["n"])(e))throw e.getControlFlowError();throw a["q"].client.userDeniedAccountAccess()}}))}function L(e={}){return(t,n)=>U(this,void 0,void 0,(function*(){const{from:o,rt:c,jwt:i}=e;const a=o==="storage"||Object(r["isUndefined"])(o);const u=o==="cookies"||Object(r["isUndefined"])(o);const{userID:d,ust:f}=n().Auth;if(a&&d&&f){try{yield t(G.populateUserCredentials());return true}catch(e){console.warn("could not authenticate via storage",e)}}if(u&&m["m"]&&!m["p"]){try{const{auth_user_id:e,auth_user_session_token:n,email:o,phone_number:c}=(yield p["a"].refresh()).data;t(Object(I["m"])(e));t(Object(I["i"])(n));t(Object(I["l"])(o));t(Object(I["p"])(c));yield t(G.populateUserCredentials());return true}catch(e){console.warn("could not authenticate via cookie",e)}}if(c&&i){try{const{auth_user_id:e,auth_user_session_token:n,refresh_token:o,email:r,phone_number:a}=(yield s["a"].getUstWithRt(c,i)).data;t(Object(I["m"])(e));t(Object(I["i"])(n));t(Object(I["h"])(o));t(Object(I["l"])(r));t(Object(I["p"])(a));yield t(G.populateUserCredentials());return true}catch(e){console.warn("could not authenticate via refresh token",e)}}yield t(G.logout({shouldCallLogoutApi:false}));l["a"].clear("eth_accounts","eth_coinbase");return false}))}function F({shouldCallLogoutApi:e}={shouldCallLogoutApi:true}){return(t,n)=>U(this,void 0,void 0,(function*(){l["a"].clear("eth_accounts","eth_coinbase");l["a"].clearByRegex(k["a"]);if(e){yield s["a"].logout(n().Auth.userID).catch(r["noop"])}t(Object(I["a"])());f["a"].rpc.post(o["FmIncomingWindowMessage"].FORTMATIC_USER_LOGOUT)}))}function N(e,t,n,o){return(c,r)=>U(this,void 0,void 0,(function*(){var i;try{const{userEmail:a}=r().Auth;const u=(i=Object(A["c"])(E["a"].Client.SendV1).ext)===null||i===void 0?void 0:i.uservoiceThemeProvider;const d=yield s["a"].loginStart(a,e,t,o,u);c(Object(S["d"])(d.data.utc_timestamp_ms));c(Object(I["f"])(d.data.login_flow_context));c(w["a"].emitJsonRpcEvent({payload:n,event:"email-sent"}))}catch(e){c(w["a"].emitJsonRpcEvent({payload:n,event:"email-not-deliverable"}));if(Object(a["n"])(e))throw e.getControlFlowError();else throw Object(a["f"])(e).getControlFlowError()}}))}function M(e,t,n){return(o,c)=>{var r;const i=(r=c().UIThread.payload)===null||r===void 0?void 0:r.id;return Object(_["a"])({delay:5e3,interval:2e3,expiresIn:1e3*60*20,onInterval:(r,u)=>U(this,void 0,void 0,(function*(){var d;try{if(i&&((d=c().UIThread.payload)===null||d===void 0?void 0:d.id)!==i)return u();const a=t!==null&&t!==void 0?t:c().Auth.userEmail;const{loginFlowContext:l}=c().Auth;const f=yield s["a"].loginStatus({email:a,requestOriginMessage:e,jwt:n,loginFlowContext:l});const{auth_user_id:v,auth_user_session_token:h,refresh_token:y}=f.data;o(Object(I["m"])(v));o(Object(I["i"])(h));o(Object(I["h"])(y));r()}catch(e){if([a["a"].LoginWithMagicLinkExpired,a["a"].OverMAUQuota,a["a"].AnomalousRequestDetected,a["a"].UnsupportedEthereumNetwork].includes(Object(a["o"])(e))){u(e)}}})),onExpire:(e,t)=>U(this,void 0,void 0,(function*(){t(Object(a["c"])(a["a"].LoginWithMagicLinkExpired))}))})}}function W(e,t,n,o,c=0){return U(this,void 0,void 0,(function*(){if(!!o&&!!t&&(o===null||o===void 0?void 0:o.should_create_delegated_wallet)){const{delegated_key_id:r}=o;try{let e;let r="";switch(n){case h["g"].ETH:{e=u["a"].createWallet();break}case h["g"].FLOW:{const n=Object(v["e"])();const o=n==="mainnet"?g["c"].mainnet:g["c"].testnet;const c=()=>U(this,void 0,void 0,(function*(){return(yield Object(y["a"])()).ledgerBridge.createWallet((e=>b["a"].flowSignMessage(t,e)),o,g["a"],Object(y["c"])(n),n)}));e=yield Object(R["a"])(c,3,.1);break}case h["g"].HEDERA:{const{network:n}=Object(v["f"])();const o=g["e"][n];e=yield(yield Object(y["a"])()).ledgerBridge.createWallet((e=>C["a"].hederaSignMessage(t,e)),o);break}default:e=yield(yield Object(y["a"])()).ledgerBridge.createWallet()}const i=yield d["a"].kmsEncrypt(e.privateKey,o,c);if(e.mnemonic)r=yield d["a"].kmsEncrypt(e.mnemonic,o,c);e.mnemonic=null;e.privateKey=null;if(i)yield s["a"].syncWallet(t,e.address,i,n,r,e.HDWalletPath);else throw new Error("Private key encryption result is falsey.")}catch(t){e(G.logout());throw a["q"].web3.failedWalletCreation()}}}))}function x(){return(e,t)=>U(this,void 0,void 0,(function*(){var n;const o=n=>U(this,void 0,void 0,(function*(){const o=(yield s["a"].getUserInfo(t().Auth.userID,n)).data;if(o.used_chain_ids){e(Object(I["j"])(o.used_chain_ids))}e(Object(I["c"])(o.delegated_wallet_info));e(Object(I["n"])({publicAddress:o.public_address,encryptedPrivateAddress:o.encrypted_private_address,walletId:o.auth_user_wallet_id}));e(Object(I["k"])(o.consent));e(Object(S["d"])(o.utc_timestamp_ms));e(Object(I["g"])(o.login.type));e(Object(I["b"])(o.client_id));e(Object(I["o"])(o.auth_user_mfa_active))}));const c=n=>U(this,void 0,void 0,(function*(){var c;yield o(n);const{Auth:r}=t();const{systemClockOffset:i}=t().System;if(n===h["g"].ETH){e(Object(I["d"])((c=r.delegatedWalletInfo)===null||c===void 0?void 0:c.should_create_delegated_wallet))}yield G.syncWallet(e,r.userID,n,r.delegatedWalletInfo,i)}));if(!Object(v["i"])())yield c(h["g"].ETH);yield c(Object(v["g"])());if((n=t().Auth.delegatedWalletInfo)===null||n===void 0?void 0:n.should_create_delegated_wallet){yield o(Object(v["g"])())}}))}function H(e){return(t,n)=>U(this,void 0,void 0,(function*(){if(m["m"]&&!m["p"]){const{userID:t}=n().Auth;yield p["a"].persist(t,e).catch((()=>{}))}}))}function V(e,t,n,o){return(c,r)=>U(this,void 0,void 0,(function*(){try{c(Object(I["m"])(e));c(Object(I["i"])(t));yield c(G.populateUserCredentials());const r=yield c(T["a"].createDIDTokenForUser(o));yield Object(O["i"])(n,r)}catch(e){yield a["q"].client.webAuthnRegistrationFailed().sdkReject(n)}}))}function Y(e,t,n="testnet"){return(o,c)=>U(this,void 0,void 0,(function*(){o(Object(I["a"])());const c=yield s["a"].redirectConfirm(e,t,n);o(Object(I["m"])(c.data.auth_user_id));o(Object(I["l"])(c.data.email));o(Object(I["i"])(c.data.ephemeral_auth_user_session_token));yield o(G.populateUserCredentials())}))}const G={sendMagicLink:N,loginWithMagicLink:D,loginWithCredential:P,hydrateActiveUser:L,populateUserCredentials:x,waitForMagicLinkClicked:M,syncWallet:W,logout:F,persistSessionCookies:H,processWebAuthnLoginSession:V,hydrateUserSessionFromRedirectConfirm:Y}},67:function(e,t,n){"use strict";n.d(t,"a",(function(){return k}));var o=n(36);var c=n.n(o);var r=n(8);var i=n.n(r);var a=n(68);var s=n(162);var u=n(776);var d=n(49);var l=n(104);var f=n(27);var v=n(224);var h=n(331);var y=n(72);var p=n(42);var m=n(62);var _=n(161);var O=undefined&&undefined.__awaiter||function(e,t,n,o){function c(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,r){function i(e){try{s(o.next(e))}catch(e){r(e)}}function a(e){try{s(o["throw"](e))}catch(e){r(e)}}function s(e){e.done?n(e.value):c(e.value).then(i,a)}s((o=o.apply(e,t||[])).next())}))};function b(e){return(t,n)=>O(this,void 0,void 0,(function*(){const t=n().Auth.userKeys.encryptedPrivateAddress;const{delegatedWalletInfo:o}=n().Auth;const{systemClockOffset:c}=n().System;let r=yield s["a"].kmsDecrypt(t,o,c);const i=a["a"].signTypedDataV1(e,r);r=null;return i}))}function g(e){return(t,n)=>O(this,void 0,void 0,(function*(){const t=n().Auth.userKeys.encryptedPrivateAddress;const{delegatedWalletInfo:o}=n().Auth;const{systemClockOffset:c}=n().System;let r=yield s["a"].kmsDecrypt(t,o,c);const i=a["a"].signTypedDataV3(e,r);r=null;return i}))}function j(e){return(t,n)=>O(this,void 0,void 0,(function*(){const t=n().Auth.userKeys.encryptedPrivateAddress;const{delegatedWalletInfo:o}=n().Auth;const{systemClockOffset:c}=n().System;let r=yield s["a"].kmsDecrypt(t,o,c);const i=a["a"].signTypedDataV4(e,r);r=null;return i}))}function A(e){return(t,n)=>O(this,void 0,void 0,(function*(){const t=n().Auth.userKeys.encryptedPrivateAddress;const{delegatedWalletInfo:o}=n().Auth;const{systemClockOffset:c}=n().System;let r=yield s["a"].kmsDecrypt(t,o,c);const i=a["a"].personalSign(e,r);r=null;return i}))}function E(e){return(t,n)=>O(this,void 0,void 0,(function*(){const t=n().Auth.userKeys.encryptedPrivateAddress;const{delegatedWalletInfo:o}=n().Auth;const{systemClockOffset:c}=n().System;let r=yield s["a"].kmsDecrypt(t,o,c);return a["a"].signTransaction(e,r).finally((()=>{r=null}))}))}function T(e){return(t,n)=>O(this,void 0,void 0,(function*(){const{Auth:c}=n();const i=yield a["a"].getChainId();const s=Object(o["hexToNumber"])(i)||1;const u=p["c"][s];let d;if((u===null||u===void 0?void 0:u.name)==="Ethereum"||(u===null||u===void 0?void 0:u.name)==="Polygon"){d=yield y["c"][u===null||u===void 0?void 0:u.name](Object(r["cloneDeep"])(e),s,c)}else{d=yield y["c"].Ethereum(Object(r["cloneDeep"])(e),s,c)}const{rawTransaction:l}=yield t(k.signTransactionForUser(d));return a["a"].sendRawTransaction(l)}))}function w(e,t){return(n,o)=>O(this,void 0,void 0,(function*(){let c=null;let r=null;let i;try{const{Auth:n}=o();const{userID:a,userKeys:v,clientID:h,delegatedWalletInfo:y}=n;const{systemClockOffset:p}=o().System;if(a&&v.publicAddress&&v.encryptedPrivateAddress&&h){if(Object(d["i"])()){c=yield s["a"].kmsDecrypt(v.encryptedPrivateAddress,y,p);r={privateKey:c,address:v.publicAddress};i=h}else{const e=(yield l["a"].getUserInfo(a,f["g"].ETH)).data;c=yield s["a"].kmsDecrypt(e.encrypted_private_address,y,p);r={privateKey:c,address:e.public_address};i=e.client_id}return u["a"].createToken({account:r,subject:a,audience:i,lifespan:e,attachment:t,systemClockOffset:o().System.systemClockOffset})}return null}catch(e){yield n(m["a"].logout());return null}finally{r=null;c=null}}))}function S(e){var t;if(e===void 0){e=((t=Object(v["a"])()._oaclientmeta)===null||t===void 0?void 0:t.encrypted_access_token)||""}return(t,n)=>O(this,void 0,void 0,(function*(){const n=15*60;if(e){return t(k.createDIDTokenForUser(n,e))}return null}))}function I(e){return(t,n)=>O(this,void 0,void 0,(function*(){var o;try{const{userID:c}=n().Auth;const{delegatedWalletInfo:r}=n().Auth;const{systemClockOffset:i}=n().System;if(Object(d["k"])()){yield l["a"].exportWallet(c)}const a=n().Auth.userKeys.encryptedPrivateAddress;e.params[0]=(o=yield s["a"].kmsDecrypt(a,r,i))===null||o===void 0?void 0:o.substring(2);yield t(_["a"].acquireLockAndShowUI(e));return"success"}catch(e){yield t(m["a"].logout());return"failed"}}))}function C(e){return(t,n)=>O(this,void 0,void 0,(function*(){try{const{userID:o}=n().Auth;yield l["a"].exportWallet(o);const c=(yield l["a"].getUserInfo(o,e.params[0].walletType)).data;const{delegatedWalletInfo:r}=n().Auth;const{systemClockOffset:i}=n().System;const a=c.encrypted_private_address;const u=yield s["a"].kmsDecrypt(a,r,i);e.params[0]=u;if(Object(d["g"])()===f["g"].SOLANA){const t=yield Object(h["b"])();e.params[0]=yield t.convertMnemonicToRawPrivateKey(e,u)}yield t(_["a"].acquireLockAndShowUI(e));return"success"}catch(e){yield t(m["a"].logout());return"failed"}}))}const k={personalSignForUser:A,signTypedDataV4ForUser:j,signTypedDataV3ForUser:g,signTypedDataV1ForUser:b,sendTransactionForUser:T,signTransactionForUser:E,createDIDTokenForUser:w,createOAuthMagicCredentialForUser:S,exportPrivateKeyForUser:I,exportPrivateKeyForUserInLedger:C}}}]);