(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[125],{78278:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/concepts/car-files",function(){return n(98965)}])},17778:function(e,t,n){"use strict";var a=n(52322),r={nextLinks:!1,prevLinks:!1,search:!1,customSearch:null,darkMode:!1,footer:!1,header:!1,logo:(0,a.jsx)(a.Fragment,{}),head:(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("title",{children:"NFT.Storage Docs"})})};t.Z=r},98965:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var a=n(70865),r=n(96670),s=n(52322),i=n(17647),o=n(49083),c=n(17778),l=n(45392),d=n(55513);function h(e){var t=Object.assign({h1:"h1",p:"p",a:"a",h2:"h2",code:"code",h3:"h3",pre:"pre",h4:"h4",em:"em",strong:"strong"},(0,l.ah)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h1,{children:"Working with Content Archives"}),"\n",(0,s.jsxs)(t.p,{children:["When you upload files to NFT.Storage using the ",(0,s.jsx)(t.a,{href:"https://nftstorage.github.io/nft.storage/client/",children:"client library"}),", your data is converted into a graph of data structures, which are then packed into a format called a Content Archive (CAR) before being sent to the NFT.Storage service."]}),"\n",(0,s.jsxs)(t.p,{children:["For many use cases, you never need to know about this process, as the conversion happens behind the scenes when using the client library.  However, if you're using the ",(0,s.jsx)(t.a,{href:"https://nft.storage/api-docs/",children:"HTTP API"}),", or if you want more control over the structure of the IPFS data graph, you may want to work with Content Archives directly."]}),"\n",(0,s.jsxs)(t.p,{children:["This how-to guide will explain ",(0,s.jsx)(t.a,{href:"#what-is-a-content-archive",children:"the basics of Content Archives"})," and ",(0,s.jsx)(t.a,{href:"#car-files-and-nft-storage",children:"how they're used by the NFT.Storage API"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["We'll also see several methods of creating and manipulating Content Archives using ",(0,s.jsx)(t.a,{href:"#command-line-tools",children:"command line tools"})," and an overview of the ",(0,s.jsx)(t.a,{href:"#libraries-for-application-developers",children:"libraries"})," you can use in your application's code."]}),"\n",(0,s.jsx)(t.h2,{children:"What is a Content Archive?"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.a,{href:"https://ipld.io/specs/transport/car/",children:"Content Archive format"})," is a way of packaging up [content addressed data][concepts-content-addressing] into archive files that can be easily stored and transferred. You can think of them like ",(0,s.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Tar_(computing)",children:"TAR files"})," that are designed for storing collections of content addressed data."]}),"\n",(0,s.jsxs)(t.p,{children:["The type of data stored in CARs is defined by ",(0,s.jsx)(t.a,{href:"https://ipld.io",children:"IPLD"}),", or InterPlanetary Linked Data. IPLD is a specification and set of implementations for structured data types that can link to each other using a hash-based Content Identifier (CID). Data linked in this way forms a Directed Acyclic Graph, or DAG, and you'll likely see a few references to DAGs in the documentation for IPLD and IPFS."]}),"\n",(0,s.jsxs)(t.p,{children:["IPFS files are one example of IPLD data, but IPLD can also be used to access data from Ethereum, Git, and other hash-addressed systems. You can also use IPLD as a general purpose format for your structured data, sort of like a Web3-flavored JSON. See ",(0,s.jsx)(t.a,{href:"#advanced-ipld-formats",children:"Advanced IPLD formats"})," below for more information."]}),"\n",(0,s.jsx)(t.h2,{children:"CARs and NFT.Storage"}),"\n",(0,s.jsx)(t.p,{children:"When the NFT.Storage client packs up regular files into a CAR to store on IPFS, the CAR contains data encoded in the same format used by IPFS when importing files using the command line or other IPFS APIs."}),"\n",(0,s.jsxs)(t.p,{children:['This format uses an IPLD "codec" called ',(0,s.jsx)(t.a,{href:"https://ipld.io/docs/codecs/known/dag-pb/",children:(0,s.jsx)(t.code,{children:"dag-pb"})}),", which uses ",(0,s.jsx)(t.a,{href:"https://developers.google.com/protocol-buffers",children:"Protocol Buffers"})," to encode an object graph. Inside the graph are ",(0,s.jsx)(t.a,{href:"https://docs.ipfs.io/concepts/file-systems/#unix-file-system-unixfs",children:"UnixFS objects"})," that describe the files and their contents."]}),"\n",(0,s.jsxs)(t.p,{children:["Although the ",(0,s.jsx)(t.a,{href:"https://nft.storage/api-docs/",children:"HTTP API"})," also allows you to upload regular files, the client prefers to send CARs for a few reasons."]}),"\n",(0,s.jsx)(t.p,{children:"First, formatting everything on the client allows us to calculate the root Content Identifier for the data you're uploading before we send any data to the remote service. This means that you can compare the CID returned by the NFT.Storage service to the one you calculated locally, and you don't have to trust the service to do the right thing."}),"\n",(0,s.jsx)(t.p,{children:"Another reason to use CARs is to support large files, which would otherwise hit size limits on the NFT.Storage backend platform. The data in a CAR is already chunked into small blocks, which makes CARs easy to split into small pieces that can be uploaded in batches."}),"\n",(0,s.jsx)(t.h2,{children:"Command line tools"}),"\n",(0,s.jsx)(t.p,{children:"There are a few ways to create and interact with CAR files from the command line."}),"\n",(0,s.jsx)(t.h3,{children:"ipfs-car"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.a,{href:"https://github.com/web3-storage/ipfs-car",children:"ipfs-car"})," JavaScript package includes a command-line tool for easily creating, unpacking, and verifying CAR files."]}),"\n",(0,s.jsxs)(t.p,{children:["To install it, you'll need ",(0,s.jsx)(t.a,{href:"https://nodejs.org",children:"Node.js"})," - we recommend the latest stable version."]}),"\n",(0,s.jsx)(t.p,{children:"You can install the command globally:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"npm install -g ipfs-car\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Or run the command with ",(0,s.jsx)(t.code,{children:"npx"})," without installing it to your PATH:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"npx ipfs-car --help\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"--pack"})," flag will create a new CAR file from a collection of input files:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"ipfs-car --pack path/to/files --output path/to/write/a.car\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Or extract files from a CAR with ",(0,s.jsx)(t.code,{children:"--unpack"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"ipfs-car --unpack path/to/my.car --output /path/to/unpack/files/to\n"})}),"\n",(0,s.jsxs)(t.p,{children:["You can also list the contents of a CAR with ",(0,s.jsx)(t.code,{children:"--list"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"ipfs-car --list path/to/my.car\n"})}),"\n",(0,s.jsxs)(t.p,{children:["For more usage information, run ",(0,s.jsx)(t.code,{children:"ipfs-car --help"}),"."]}),"\n",(0,s.jsx)(t.h3,{children:"go-ipfs"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.a,{href:"https://docs.ipfs.io/install/command-line/",children:(0,s.jsx)(t.code,{children:"go-ipfs"})})," is the reference implementation of the IPFS protocol. Among many other features, ",(0,s.jsx)(t.code,{children:"go-ipfs"})," supports exporting any IPFS object graph into a CAR file and importing data from CAR files into your local IPFS repository."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.a,{href:"https://docs.ipfs.io/reference/cli/#ipfs-dag-export",children:(0,s.jsx)(t.code,{children:"ipfs dag export"})})," command will fetch an IPFS object graph by its Content ID (CID), writing a stream of CAR data to standard output."]}),"\n",(0,s.jsxs)(t.p,{children:["To create a CAR file using go-ipfs, you can redirect the output of ",(0,s.jsx)(t.code,{children:"ipfs dag export"})," to a file:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:'cid="bafybeigdmvh2wgmryq5ovlfu4bd3yiljokhzdep7abpe4c4lrf6rukkx4m"\nipfs dag export $cid > path/to/output.car\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Note that you should replace the value of ",(0,s.jsx)(t.code,{children:"cid"})," inside the quotes with the CID you want to export."]}),"\n",(0,s.jsxs)(t.p,{children:["If you don't have the CID in your local IPFS repository, the ",(0,s.jsx)(t.code,{children:"dag export"})," command will try to fetch it over the IPFS network."]}),"\n",(0,s.jsxs)(t.p,{children:["To add the contents of a CAR file to your local IPFS repository, you can use ",(0,s.jsx)(t.code,{children:"ipfs dag import"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"ipfs dag import path/to/input.car\n"})}),"\n",(0,s.jsx)(t.h2,{children:"Libraries for application developers"}),"\n",(0,s.jsx)(t.h3,{children:"JavaScript"}),"\n",(0,s.jsx)(t.p,{children:"There are two JavaScript packages available for manipulating CARs inside your application."}),"\n",(0,s.jsx)(t.h4,{children:"ipfs-car"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"ipfs-car"})," package includes library functions for packing and unpacking files into CARs, using the IPFS UnixFs data model. The library includes the same functionality as the ",(0,s.jsx)(t.code,{children:"ipfs-car"})," command line utility described above."]}),"\n",(0,s.jsxs)(t.p,{children:["See the ",(0,s.jsx)(t.a,{href:"https://github.com/web3-storage/ipfs-car#api",children:"ipfs-car README"})," for API documentation and usage examples."]}),"\n",(0,s.jsx)(t.h4,{children:"@ipld/car"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsxs)(t.a,{href:"https://github.com/ipld/js-car",children:[(0,s.jsx)(t.code,{children:"@ipld/car"})," package"]})," contains the main JavaScript implementation of the CAR specification and is used by ",(0,s.jsx)(t.code,{children:"ipfs-car"})," under the hood. If you want to store non-file data using ",(0,s.jsx)(t.a,{href:"#advanced-ipld-formats",children:"advanced IPLD formats"}),", you should use ",(0,s.jsx)(t.code,{children:"@ipld/car"})," directly."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"@ipld/car"})," also provides the ",(0,s.jsx)(t.code,{children:"CarReader"})," interface used by the NFT.Storage client's ",(0,s.jsxs)(t.a,{href:"https://nftstorage.github.io/nft.storage/client/classes/lib.NFTStorage.html#storeCar",children:[(0,s.jsx)(t.code,{children:"storeCar"})," method"]}),"."]}),"\n",(0,s.jsx)(t.p,{children:"Here's a simple example of loading a CAR file from a Node.js stream and storing it with NFT.Storage:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"import { createReadStream } from 'fs'\nimport { CarReader } from '@ipld/car'\n\nasync function storeCarFile(filename) {\n  const inStream = createReadStream(filename)\n  const car = await CarReader.fromIterable(inStream)\n  \n  const client = makeStorageClient()\n  const cid = await client.putCar(car)\n  console.log('Stored CAR file! CID:', cid)\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"CarReader.fromIterable"})," accepts any iterable of ",(0,s.jsx)(t.code,{children:"Uint8Array"})," data, including Node.js streams. If you have all your CAR data in a single ",(0,s.jsx)(t.code,{children:"Uint8Array"})," already, you can use ",(0,s.jsx)(t.a,{href:"https://github.com/ipld/js-car#CarReader__fromBytes",children:(0,s.jsx)(t.code,{children:"CarReader.fromBytes"})})," instead."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"CarReader"})," type shown above will read the entire contents of the CAR into memory, which may cause issues with large files. On Node.js, you can use ",(0,s.jsx)(t.a,{href:"https://github.com/ipld/js-car#carindexedreader",children:(0,s.jsx)(t.code,{children:"CarIndexedReader"})}),", which reads CAR data from disk directly and uses less memory than ",(0,s.jsx)(t.code,{children:"CarReader"}),"."]}),"\n",(0,s.jsx)(t.h3,{children:"Go"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsxs)(t.a,{href:"https://github.com/ipld/go-car",children:[(0,s.jsx)(t.code,{children:"go-car"})," module"]})," provides the main Golang implementation of the CAR specification. We recommend using the ",(0,s.jsx)(t.code,{children:"v2"})," module version, which supports the latest version of the CAR spec."]}),"\n",(0,s.jsxs)(t.p,{children:["See the ",(0,s.jsx)(t.a,{href:"https://pkg.go.dev/github.com/ipld/go-car/v2",children:"API reference documentation"})," for more information."]}),"\n",(0,s.jsx)(t.h2,{children:"Splitting CARs for upload to NFT.Storage"}),"\n",(0,s.jsxs)(t.p,{children:["The NFT.Storage ",(0,s.jsx)(t.a,{href:"https://nft.storage/api-docs/",children:"HTTP API"})," accepts CAR uploads up to 100 MB in size, but the JavaScript client uses the HTTP API to upload files of ",(0,s.jsx)(t.em,{children:"any"})," size. The client manages to do this by splitting CARs into chunks of less than 100 MB each and uploading each chunk separately."]}),"\n",(0,s.jsxs)(t.p,{children:["The main tool available for splitting and joining CARs is called ",(0,s.jsx)(t.code,{children:"carbites"}),", which has implementations in JavaScript and Go. The JavaScript implementation includes a command-line version that allows you to split and join CARs from your terminal or favorite scripting language."]}),"\n",(0,s.jsxs)(t.p,{children:["This section will demonstrate a few ways to split CARs in a way that's acceptable to the NFT.Storage service, using the command line tool, as well as programmatically using the ",(0,s.jsx)(t.code,{children:"carbites"})," libraries in JavaScript and Go."]}),"\n",(0,s.jsx)(t.h2,{children:"Using the carbites-cli tool"}),"\n",(0,s.jsxs)(t.p,{children:["The JavaScript ",(0,s.jsx)(t.a,{href:"https://github.com/nftstorage/carbites",children:"carbites library"})," includes a package called ",(0,s.jsx)(t.code,{children:"carbites-cli"})," that can split and join CARs from the command line. You'll need a recent version of ",(0,s.jsx)(t.a,{href:"https://nodejs.org",children:"Node.js"})," installed, preferably the latest stable version."]}),"\n",(0,s.jsxs)(t.p,{children:["You can install the tool globally with ",(0,s.jsx)(t.code,{children:"npm"}),":"]}),"\n",(0,s.jsx)(t.pre,{"with-output":!0,children:(0,s.jsx)(t.code,{className:"language-shell",children:"npm install -g carbites-cli\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"added 71 packages, and audited 72 packages in 846ms\n20 packages are looking for funding\n  run `npm fund` for details\nfound 0 vulnerabilities\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This will add a ",(0,s.jsx)(t.code,{children:"carbites"})," command to your shell's environment:"]}),"\n",(0,s.jsx)(t.pre,{"with-output":!0,children:(0,s.jsx)(t.code,{className:"language-shell",children:"carbites --help\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"  CLI tool for splitting a single CAR into multiple CARs from the comfort of your terminal.\n  Usage\n    $ carbites <command>\n    Commands\n      split\n      join\n"})}),"\n",(0,s.jsxs)(d.Z,{emoji:"\ud83d\udca1",children:[(0,s.jsxs)(t.p,{children:["You can run the ",(0,s.jsx)(t.code,{children:"carbites"})," command without installing it globally using the ",(0,s.jsx)(t.code,{children:"npx"})," command, which is included with Node.js:"]}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"npx carbites-cli --help\n"})}),(0,s.jsx)(t.p,{children:"The first time around, it will ask to make sure you want to install the package:"}),(0,s.jsx)(t.pre,{output:!0,children:(0,s.jsx)(t.code,{className:"language-text",children:"Need to install the following packages:\n  carbites-cli\nOk to proceed? (y)\n"})}),(0,s.jsxs)(t.p,{children:["After that, you can use ",(0,s.jsx)(t.code,{children:"npx carbites-cli"})," instead of ",(0,s.jsx)(t.code,{children:"carbites"})," for any of the commands below!"]})]}),"\n",(0,s.jsx)(t.h4,{children:"Splitting CARs"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"carbites split"})," command takes a CAR file as input and splits it into multiple smaller CARs."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"--size"})," flag sets the maximum size of the output CAR files. For uploading to NFT.Storage, ",(0,s.jsx)(t.code,{children:"--size"})," must be less than ",(0,s.jsx)(t.code,{children:"100MB"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["The other important flag is ",(0,s.jsx)(t.code,{children:"--strategy"}),", which determines how the CAR files are split. For NFT.Storage uploads, we need to use the ",(0,s.jsx)(t.code,{children:"treewalk"})," strategy, so that all of our CARs share the same root CID. This will allow the NFT.Storage service to piece them all together again once they've all been uploaded."]}),"\n",(0,s.jsxs)(t.p,{children:["Here's an example, using an input car file called ",(0,s.jsx)(t.code,{children:"my-video.car"})," that weighs in at 455MB:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"carbites split --size 100MB --strategy treewalk my-video.car\n"})}),"\n",(0,s.jsxs)(t.p,{children:["This will create five new files in the same directory as the input file, named ",(0,s.jsx)(t.code,{children:"my-video-0.car"})," through ",(0,s.jsx)(t.code,{children:"my-video-4.car"}),". If you list their sizes, you can see that all the chunked cars are less than or equal to 100 MB:"]}),"\n",(0,s.jsx)(t.pre,{"with-output":!0,children:(0,s.jsx)(t.code,{className:"language-shell",children:"ls -lh my-video*\n"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{children:"-rw-r--r--  1 user  staff   100M Sep 15 13:56 my-video-1.car\n-rw-r--r--  1 user  staff   100M Sep 15 13:56 my-video-0.car\n-rw-r--r--  1 user  staff   100M Sep 15 13:56 my-video-2.car\n-rw-r--r--  1 user  staff   100M Sep 15 13:56 my-video-3.car\n-rw-r--r--  1 user  staff    56M Sep 15 13:56 my-video-4.car\n-rw-r--r--  1 user  staff   455M Sep 15 13:52 my-video.car\n"})}),"\n",(0,s.jsx)(t.h4,{children:"Joining CARs"}),"\n",(0,s.jsxs)(t.p,{children:["To combine CARs that have been previously split, you can use the ",(0,s.jsx)(t.code,{children:"carbites join"})," command:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"carbites join my-video-*.car --output my-video-joined.car\n"})}),"\n",(0,s.jsx)(t.h2,{children:"Using JavaScript code"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.a,{href:"https://github.com/nftstorage/carbites",children:"carbites library"})," provides an interface for splitting CARs that can be invoked from your application code."]}),"\n",(0,s.jsxs)(d.Z,{emoji:"\ud83d\udca1",children:[(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"You probably don't need this!"})}),(0,s.jsxs)(t.p,{children:["If you're using JavaScript, you can ",(0,s.jsx)(t.a,{href:"https://nft.storage/docs/how-to/mint-custom-metadata/",children:"use the NFT.Storage client"})," to upload your data and let the client take care of CAR splitting for you. If you're sure you want to split CARs from JavaScript yourself, read on!"]})]}),"\n",(0,s.jsxs)(t.p,{children:["To split CARs from your JavaScript code, install the ",(0,s.jsx)(t.code,{children:"carbites"})," package:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"npm install carbites\n"})}),"\n",(0,s.jsxs)(t.p,{children:["And import the ",(0,s.jsx)(t.code,{children:"TreewalkCarSplitter"})," class into your code:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"import { TreewalkCarSplitter } from 'carbites/treewalk'\n"})}),"\n",(0,s.jsxs)(t.p,{children:["You can create a ",(0,s.jsx)(t.code,{children:"TreewalkCarSplitter"})," by passing in a ",(0,s.jsx)(t.code,{children:"CarReader"})," and a ",(0,s.jsx)(t.code,{children:"targetSize"})," in bytes for the output cars. See the section on @ipld/car for more information on ",(0,s.jsx)(t.code,{children:"CarReader"}),". For now, we'll assume that the ",(0,s.jsx)(t.code,{children:"loadLargeCar"})," function returns a ",(0,s.jsx)(t.code,{children:"CarReader"}),", and we'll use the ",(0,s.jsx)(t.code,{children:"TreewalkCarSplitter"})," to create split CARs:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"import { TreewalkCarSplitter } from 'carbites/treewalk'\nasync function splitCars() {\n  const largeCar = await loadLargeCar()\n  const targetSize = 100000000\n  const splitter = new TreewalkCarSplitter(largeCar, targetSize)\n  for await (const smallCar of splitter.cars()) {\n    // Each small car is an AsyncIterable<Uint8Array> of CAR data\n    for await (const chunk of smallCar) {\n      // Do something with the car data...\n      // For example, you could upload it to the NFT.storage HTTP API\n      // https://nft.storage/api-docs\n    }\n    // You can also get the root CID of each small CAR with the getRoots method:\n    const roots = await smallCar.getRoots()\n    console.log('root cids', roots)\n    // Since we're using TreewalkCarSpliter, all the smaller CARs should have the\n    // same root CID as the large input CAR.\n  }\n}\n"})}),"\n",(0,s.jsx)(t.h2,{children:"Using Go code"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.a,{href:"https://github.com/alanshaw/go-carbites",children:"go-carbites"})," module can be used to split large CARs from your Go applications."]}),"\n",(0,s.jsxs)(t.p,{children:["Install the module with ",(0,s.jsx)(t.code,{children:"go get"}),":"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-shell",children:"go get github.com/alanshaw/go-carbites\n"})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsxs)(t.a,{href:"https://pkg.go.dev/github.com/alanshaw/go-carbites#Split",children:[(0,s.jsx)(t.code,{children:"carbites.Split"})," function"]})," returns a ",(0,s.jsx)(t.a,{href:"https://pkg.go.dev/github.com/alanshaw/go-carbites#Splitter",children:(0,s.jsx)(t.code,{children:"carbites.Splitter"})})," that will make sure that the output CARs all have the same root CID, which is important when uploading to NFT.Storage."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-go",children:'package main\n\nimport (\n  "io"\n  "os"\n  "github.com/alanshaw/go-carbites"\n)\n\nfunc main() {\n  bigCar, _ := os.Open("big.car")\n  targetSize := 1024 * 1024 // 1MiB chunks\n  strategy := carbites.Treewalk\n  spltr, _ := carbites.Split(bigCar, targetSize, strategy)\n\n  var i int\n  for {\n  \tcar, err := spltr.Next()\n  \tif err != nil {\n  \t\tif err == io.EOF {\n  \t\t\tbreak\n  \t\t}\n  \t\tpanic(err)\n  \t}\n  \tb, _ := ioutil.ReadAll(car)\n  \tioutil.WriteFile(fmt.Sprintf("chunk-%d.car", i), b, 0644)\n  \ti++\n  }\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["You can also use ",(0,s.jsx)(t.a,{href:"https://pkg.go.dev/github.com/alanshaw/go-carbites#NewTreewalkSplitterFromPath",children:(0,s.jsx)(t.code,{children:"NewTreewalkSplitterFromPath"})}),", which takes a local file path instead of an ",(0,s.jsx)(t.code,{children:"io.Reader"}),"."]}),"\n",(0,s.jsx)(t.h2,{children:"Advanced IPLD formats"}),"\n",(0,s.jsxs)(t.p,{children:["IPLD can also be used as a general purpose data format like JSON. In fact, you can use JSON directly as IPLD just by using a special convention for linking to other IPLD objects. This convention is defined in the ",(0,s.jsxs)(t.a,{href:"https://ipld.io/docs/codecs/known/dag-json/",children:[(0,s.jsx)(t.code,{children:"dag-json"}),' "codec"']}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Here's an example of a ",(0,s.jsx)(t.code,{children:"dag-json"})," object:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "name": "Have you seen this dog?",\n  "description": "I have now...",\n  "image": { "/": "bafybeihkqv2ukwgpgzkwsuz7whmvneztvxglkljbs3zosewgku2cfluvba" }\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"image"}),' field uses the special "link type" to reference another IPLD object. The link is just a regular JSON object with a single key named ',(0,s.jsx)(t.code,{children:"/"}),", whose value is a Content Identifier."]}),"\n",(0,s.jsxs)(t.p,{children:["Although ",(0,s.jsx)(t.code,{children:"dag-json"})," is familiar and easy to use, we recommend using the similar ",(0,s.jsxs)(t.a,{href:"https://ipld.io/docs/codecs/known/dag-cbor/",children:[(0,s.jsx)(t.code,{children:"dag-cbor"})," codec"]})," instead. ",(0,s.jsx)(t.code,{children:"dag-cbor"})," uses the ",(0,s.jsx)(t.a,{href:"https://cbor.io",children:"Concise Binary Object Representation"})," to more efficiently encode data, especially binary data which must be Base64-encoded when using ",(0,s.jsx)(t.code,{children:"dag-json"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["You may already be using ",(0,s.jsx)(t.code,{children:"dag-cbor"})," without knowing it! When using the client library's ",(0,s.jsx)(t.code,{children:"store"})," method or the HTTP API's ",(0,s.jsx)(t.code,{children:"/store"})," endpoint, NTF.Storage creates a ",(0,s.jsx)(t.code,{children:"dag-cbor"}),' "bundle" that includes the NFT metadata with native IPLD links to all of the files referenced in the NFT, including a JSON version of the metadata for compatibility.']})]})}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},(0,l.ah)(),e.components),n=t.wrapper;return n?(0,s.jsx)(n,(0,r.Z)((0,a.Z)({},e),{children:(0,s.jsx)(h,(0,a.Z)({},e))})):h(e)}var u=(0,s.jsx)(p,{});function m(e){return(0,o.withSSG)((0,i.Z)({filename:"car-files.md",route:"/docs/concepts/car-files",meta:{title:"Working with Content Archives",sidebar_label:"Work with Content Archives",description:"Learn how to work with Content Archives of IPLD data."},pageMap:[{name:"docs",children:[{name:"client",children:[{name:"http",route:"/docs/client/http"},{name:"js",route:"/docs/client/js"},{name:"meta.json",meta:{js:{title:"JavaScript",type:"docs"},http:"HTTP API"}}],route:"/docs/client"},{name:"concepts",children:[{name:"architecture-considerations",route:"/docs/concepts/architecture-considerations",frontMatter:{title:"Architecture considerations"}},{name:"car-files",route:"/docs/concepts/car-files",frontMatter:{title:"Working with Content Archives",sidebar_label:"Work with Content Archives",description:"Learn how to work with Content Archives of IPLD data."}},{name:"decentralized-storage",route:"/docs/concepts/decentralized-storage",frontMatter:{title:"Decentralized storage",description:"Learn about decentralized storage works and how it's key to NFT.Storage."}},{name:"gateways",route:"/docs/concepts/gateways"},{name:"meta.json",meta:{"decentralized-storage":"Decentralized storage","car-files":"Work with Content Archives","architecture-considerations":"Architecture considerations"}}],route:"/docs/concepts"},{name:"how-to",children:[{name:"get-status",route:"/docs/how-to/get-status"},{name:"meta.json",meta:{"mint-erc-1155":"Store and mint NFTs using ERC-1155 metadata standards","mint-custom-metadata":"Store and mint NFTs using custom metadata","mint-solana":"Store and mint NFTs for Solana with Metaplex",retrieve:"Retrieve NFT data from IPFS","store-directory":"Store a directory of files","get-status":"Get upload status",ucan:"Use UCAN tokens for delegated authorization","pinning-service":"Pinning Services API",nftup:"Upload with NFTUp"}},{name:"mint-custom-metadata",route:"/docs/how-to/mint-custom-metadata",frontMatter:{title:"Store and mint NFTs using custom metadata"}},{name:"mint-erc-1155",route:"/docs/how-to/mint-erc-1155",frontMatter:{title:"Store and mint NFTs using ERC-1155 metadata standards"}},{name:"mint-solana",route:"/docs/how-to/mint-solana",frontMatter:{title:"Mint NFTs on Solana with Metaplex"}},{name:"nftup",route:"/docs/how-to/nftup",frontMatter:{title:"Upload files and directories with NFTUp"}},{name:"pinning-service",route:"/docs/how-to/pinning-service"},{name:"retrieve",route:"/docs/how-to/retrieve",frontMatter:{title:"Retrieve NFT data from IPFS"}},{name:"store-directory",route:"/docs/how-to/store-directory"},{name:"ucan",route:"/docs/how-to/ucan"}],route:"/docs/how-to"},{name:"meta.json",meta:{quickstart:"Quickstart","why-nft-storage":"Why NFT.Storage",troubleshooting:"Troubleshooting","api-docs":"Api Docs",concepts:"Concepts","how-to":"How To",client:"Client libraries"}},{name:"quickstart",route:"/docs/quickstart",frontMatter:{title:"Welcome"}},{name:"troubleshooting",route:"/docs/troubleshooting",frontMatter:{title:"Troubleshooting"}},{name:"why-nft-storage",route:"/docs/why-nft-storage",frontMatter:{title:"Why NFT.Storage?"}}],route:"/docs"}]},c.Z))((0,r.Z)((0,a.Z)({},e),{children:u}))}},55513:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var a=n(2784),r={default:"bg-orange-100 text-orange-800 dark:text-orange-300 dark:bg-orange-200 dark:bg-opacity-10",error:"bg-red-200 text-red-900 dark:text-red-200 dark:bg-red-600 dark:bg-opacity-30",warning:"bg-yellow-200 text-yellow-900 dark:text-yellow-200 dark:bg-yellow-700 dark:bg-opacity-30"},s=({children:e,type:t="default",emoji:n="\ud83d\udca1"})=>a.createElement("div",{className:`${r[t]} flex rounded-lg callout mt-6`},a.createElement("div",{className:"pl-3 pr-2 py-2 select-none text-xl",style:{fontFamily:'"Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'}},n),a.createElement("div",{className:"pr-4 py-2"},e))}},function(e){e.O(0,[619,774,888,179],(function(){return t=78278,e(e.s=t);var t}));var t=e.O();_N_E=t}]);